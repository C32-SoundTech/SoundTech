# 搜索功能测试用例文档

### 1. 搜索页面加载测试
- **测试ID**: T-SEARCH-01
- **测试目的**: 验证搜索页面是否正常加载
- **前置条件**: 应用程序正常运行，用户已登录
- **测试步骤**:
  1. 访问 `/search` 路由
- **预期结果**:
  1. 返回状态码 200
  2. 页面内容包含搜索表单和搜索按钮
- **测试类型**: 功能测试

### 2. 空查询搜索测试
- **测试ID**: T-SEARCH-02
- **测试目的**: 验证当搜索关键词为空时的处理
- **前置条件**: 应用程序正常运行，用户已登录
- **测试步骤**:
  1. 向 `/search` 路由发送 POST 请求，包含:
     - query: ""
- **预期结果**:
  1. 返回状态码 200
  2. 页面不显示任何搜索结果
  3. search_util 函数不被调用
- **测试类型**: 验证测试

### 3. 有效关键词搜索测试
- **测试ID**: T-SEARCH-03
- **测试目的**: 验证使用有效关键词进行搜索时能否返回正确结果
- **前置条件**: 应用程序正常运行，用户已登录，数据库中存在包含关键词的题目
- **测试步骤**:
  1. 向 `/search` 路由发送 POST 请求，包含:
     - query: "测试关键词"
- **预期结果**:
  1. 返回状态码 200
  2. search_util 函数被调用一次，参数为 "测试关键词"
  3. 页面显示包含该关键词的题目列表
- **测试类型**: 功能测试

### 4. 无结果搜索测试
- **测试ID**: T-SEARCH-04
- **测试目的**: 验证搜索不存在的关键词时的处理
- **前置条件**: 应用程序正常运行，用户已登录，数据库中不存在包含关键词的题目
- **测试步骤**:
  1. 向 `/search` 路由发送 POST 请求，包含:
     - query: "不存在的关键词"
- **预期结果**:
  1. 返回状态码 200
  2. search_util 函数被调用一次，参数为 "不存在的关键词"
  3. 页面不显示任何搜索结果或显示"未找到匹配的题目"提示
- **测试类型**: 功能测试

### 5. 特殊字符搜索测试
- **测试ID**: T-SEARCH-05
- **测试目的**: 验证使用特殊字符进行搜索时的处理
- **前置条件**: 应用程序正常运行，用户已登录
- **测试步骤**:
  1. 向 `/search` 路由发送 POST 请求，包含:
     - query: "%_[]'"
- **预期结果**:
  1. 返回状态码 200
  2. 应用程序不出现SQL注入错误
  3. search_util 函数能正确处理特殊字符
- **测试类型**: 安全测试

### 6. 长关键词搜索测试
- **测试ID**: T-SEARCH-06
- **测试目的**: 验证使用长字符串进行搜索时的处理
- **前置条件**: 应用程序正常运行，用户已登录
- **测试步骤**:
  1. 向 `/search` 路由发送 POST 请求，包含:
     - query: 包含500个字符的长字符串
- **预期结果**:
  1. 返回状态码 200
  2. 应用程序能正常处理长字符串
  3. 不出现性能问题或崩溃
- **测试类型**: 性能测试

### 7. 未登录访问测试
- **测试ID**: T-SEARCH-07
- **测试目的**: 验证未登录用户访问搜索页面时的处理
- **前置条件**: 应用程序正常运行，用户未登录
- **测试步骤**:
  1. 向 `/search` 路由发送 GET 请求
- **预期结果**:
  1. 页面重定向到登录页面
  2. 重定向URL包含 next 参数指向搜索页面
- **测试类型**: 安全测试

### 8. 搜索结果分页测试
- **测试ID**: T-SEARCH-08
- **测试目的**: 验证当搜索结果较多时的分页功能
- **前置条件**: 应用程序正常运行，用户已登录，数据库中存在大量包含关键词的题目
- **测试步骤**:
  1. 向 `/search` 路由发送 POST 请求，包含:
     - query: 能匹配大量题目的关键词
- **预期结果**:
  1. 返回状态码 200
  2. 页面显示分页控件
  3. 每页显示合理数量的结果
- **测试类型**: 功能测试

### 9. 搜索结果点击测试
- **测试ID**: T-SEARCH-09
- **测试目的**: 验证点击搜索结果能否正确跳转到题目详情页
- **前置条件**: 应用程序正常运行，用户已登录，已执行搜索并有结果显示
- **测试步骤**:
  1. 点击搜索结果中的题目链接
- **预期结果**:
  1. 页面跳转到对应题目的详情页
  2. 题目ID与搜索结果中的ID一致
- **测试类型**: 功能测试

### 10. 搜索功能性能测试
- **测试ID**: T-SEARCH-10
- **测试目的**: 验证搜索功能在高负载下的性能表现
- **前置条件**: 应用程序正常运行，用户已登录，数据库中存在大量题目
- **测试步骤**:
  1. 在短时间内多次发送搜索请求
  2. 使用不同的关键词进行搜索
- **预期结果**:
  1. 所有请求均能在合理时间内返回结果
  2. 应用程序保持稳定，不出现崩溃
  3. 数据库连接正常关闭，不出现连接泄漏
- **测试类型**: 性能测试